<div>
    <div>
        {{'STATISTICS.DOWNLOAD_TEMPLATE_HINT' | translateHs : {app} }} <a download="template.csv"
            [hsDownload]="uploadTemplate" mimeType="text/csv" [href]="downloadData"
            (downloadPrepared)="downloadData = $event" [title]="'STATISTICS.HERE' | translateHs: {app} ">
            {{'STATISTICS.HERE' |
            translateHs : {app} }}</a>.<br/> Example dataset for life satisfaction of people aged over 16: <a href="assets/life_satisfaction_over_16.csv" target="_blank">life_satisfaction_over_16.csv</a>. <br/>Example dataset for energy consumption in kilograms of oil per capita per year: <a href="assets/energy_consumption.csv" target="_blank">energy_consumption.csv</a>. 
    </div>
    <div class="form-group m-3">
        <hs-file-upload (uploaded)="handleFileUpload($event)" [app]="app" uploader="hs-sld-upload"
            acceptedFormats=".csv">
        </hs-file-upload>
    </div>
    <div class="d-flex justify-content-end">
        <button type="button" class="btn m-1 btn-secondary" (click)="rowsCollapsed = !rowsCollapsed"
            *ngIf="dataAvailable()">{{'STATISTICS.COLLAPSE_ROWS' |
            translateHs : {app} }}</button>
    </div>
    <ng-container>
        <table class="table table-striped table-bordered"
            style="table-layout: fixed;max-height: 500px;display: block;overflow-y: scroll;">
            <thead>
                <th *ngFor="let col of columns" style="min-width: 6em">
                    <select class="form-control form-select" style="border: none;" [(ngModel)]="uses[col]">
                        <option value="ignore">Ignore</option>
                        <option value="location">Location</option>
                        <option value="time">Time</option>
                        <option value="variable">Variable</option>
                    </select>
                </th>
            </thead>
            <thead style="vertical-align: middle;">
                <th *ngFor="let col of columns">
                    <ng-container *ngIf="uses[col] !== 'variable'">
                        {{col}}
                    </ng-container>
                    <input *ngIf="uses[col] === 'variable'" class="form-control" [(ngModel)]="columnAliases[col]"/>
                </th>
            </thead>
            <tbody [hidden]="rowsCollapsed">
                <tr *ngFor="let row of rows | slice:0:limitShown">
                    <td *ngFor="let col of columns">{{row[col]}}</td>
                </tr>
            </tbody>
        </table>
    </ng-container>
    <div class="d-flex justify-content-between">
        <div class="btn-group" data-toggle="buttons" *ngIf="dataAvailable()">
            <button type="button" class="btn btn-primary"
                (click)="hsStatisticsService.store(rows, columns, columnAliases, uses, app)">{{'STATISTICS.STORE' |
                translateHs : {app} }}</button>
            <button type="button" class="btn btn-secondary" (click)="visualizeInMap()">{{'STATISTICS.VISUALIZE_MAP'
                |
                translateHs : {app} }}</button>
        </div>

        <ng-container *ngIf="!rowsCollapsed && dataAvailable()">
            <div class="btn-group" data-toggle="buttons"><button type="button" class="btn bts-sm btn-secondary"
                    (click)="rowsShown('more')">{{'COMMON.more' |
                    translateHs : {app} }}</button>
                <button type="button" class="btn bts-sm btn-secondary" (click)="rowsShown('less')">{{'COMMON.less'
                    |
                    translateHs : {app} }}</button>
            </div>
        </ng-container>
    </div>
</div>